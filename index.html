<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Recruiting Manager Experiment</title>
  <script src="https://unpkg.com/jspsych@8.2.2"></script>
  <script src="https://unpkg.com/@jspsych/plugin-html-button-response@2.1.0"></script>
  <link rel="stylesheet" href="https://unpkg.com/jspsych@7.3.4/css/jspsych.css">
  <style>
    body { font-family: Arial, sans-serif; }
    .container { display: flex; gap: 20px; margin-bottom: 30px; }
    .dropzone {
      border: 2px dashed #ccc;
      padding: 10px;
      min-height: 150px;
      width: 200px;
      border-radius: 8px;
      background-color: #fdfdfd;
    }
    .task {
      padding: 10px;
      margin: 5px;
      border-radius: 5px;
      cursor: grab;
      user-select: none;
    }
    .yellow { background-color: #f9e79f; }
    .blue { background-color: #aed6f1; }
  </style>
</head>
<body></body>
<script>
  const jsPsych = initJsPsych({
    on_finish: function() {
      jsPsych.data.displayData();
    }
  });

  const allocationTrial = {
    type: jsPsychHtmlButtonResponse,
    stimulus: `
      <h2>Drag each task to the candidate you think should complete it</h2>
      <div class="container">
        <div id="candidate1" class="dropzone">
          <h3>Alex</h3>
          <p>Strong collaborator, loves brainstorming.</p>
        </div>
        <div id="candidate2" class="dropzone">
          <h3>Sam</h3>
          <p>Detail-oriented, works well independently.</p>
        </div>
        <div id="candidate3" class="dropzone">
          <h3>Taylor</h3>
          <p>Creative thinker, adaptable.</p>
        </div>
      </div>
      <h3>Tasks</h3>
      <div id="task-pool">
        <div class="task yellow" draggable="true">Co-create a detailed plan for a product launch</div>
        <div class="task yellow" draggable="true">Collaborate to develop a group presentation</div>
        <div class="task yellow" draggable="true">Jointly design a workflow for a new process</div>
        <div class="task blue" draggable="true">Create a detailed plan independently</div>
        <div class="task blue" draggable="true">Prepare an individual presentation</div>
        <div class="task blue" draggable="true">Design a workflow independently</div>
      </div>
    `,
    choices: ['Continue'],
    on_load: function() {
      // Drag and drop logic
      const tasks = document.querySelectorAll('.task');
      const zones = document.querySelectorAll('.dropzone');
      const pool = document.getElementById('task-pool');

      // Make tasks draggable
      tasks.forEach(task => {
        task.addEventListener('dragstart', function(e) {
          e.dataTransfer.setData('text/plain', [...tasks].indexOf(task));
        });
      });

      // Make dropzones accept tasks
      zones.forEach(zone => {
        zone.addEventListener('dragover', function(e) {
          e.preventDefault();
        });
        zone.addEventListener('drop', function(e) {
          e.preventDefault();
          const idx = e.dataTransfer.getData('text/plain');
          const draggedTask = document.querySelectorAll('.task')[idx];
          zone.appendChild(draggedTask);
        });
      });

      // Optionally allow dropping back to pool
      pool.addEventListener('dragover', function(e) {
        e.preventDefault();
      });
      pool.addEventListener('drop', function(e) {
        e.preventDefault();
        const idx = e.dataTransfer.getData('text/plain');
        const draggedTask = document.querySelectorAll('.task')[idx];
        pool.appendChild(draggedTask);
      });
    },
    on_finish: function(data) {
      // Collect the allocation
      function getTasks(zoneId) {
        const zone = document.getElementById(zoneId);
        if (!zone) return [];
        return Array.from(zone.querySelectorAll('.task')).map(t => t.textContent);
      }
      data.allocations = {
        Alex: getTasks('candidate1'),
        Sam: getTasks('candidate2'),
        Taylor: getTasks('candidate3'),
        Unassigned: getTasks('task-pool')
      };
    }
  };

  jsPsych.run([allocationTrial]);
</script>
</html>